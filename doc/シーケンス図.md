 **é¡§å®¢ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«** 

---

# é¡§å®¢çŠ¶æ…‹ã¨Managerå¯¾å¿œ

## 1ï¸âƒ£ çŠ¶æ…‹ç®¡ç†ã¨æ‹…å½“è€…

| Customer.state         | æ„å‘³            | ç®¡ç†è€… / å‡¦ç†æ‹…å½“                    | å‡¦ç†å†…å®¹                                     |
| ---------------------- | ------------- | ----------------------------- | ---------------------------------------- |
| `spawned`              | æ–°è¦ç”Ÿæˆ          | CustomerManager               | é¡§å®¢ç”Ÿæˆã€åº—å¤–åˆæœŸä½ç½®è¨­å®š                            |
| `assigned_to_entrance` | å…¥å£å‰²å½“          | CustomerManager               | å…¥å£åº§æ¨™å‰²å½“ã€`target_pos` è¨­å®š                   |
| `moving_to_entrance`   | å…¥å£ã¾ã§ç§»å‹•ä¸­       | Customer                      | `update(dt, map)` ã«ã‚ˆã‚‹ç§»å‹•                  |
| `arrived_at_entrance`  | å…¥å£åˆ°ç€          | Customer + CustomerManager    | ç§»å‹•å®Œäº†åˆ¤å®šã€æ¬¡çŠ¶æ…‹ `moving_to_wait`              |
| `moving_to_wait`       | å¾…æ©Ÿå ´æ‰€ç§»å‹•ä¸­       | CustomerManager + Customer    | ç©ºã„ã¦ã„ã‚‹Wãƒã‚¸ã‚·ãƒ§ãƒ³å‰²å½“ã€ç§»å‹•é–‹å§‹                       |
| `waiting`              | å¾…æ©Ÿä¸­           | CustomerManager               | åº§å¸­ãŒç©ºãã¾ã§å¾…æ©Ÿ                                |
| `moving_to_seat`       | åº§å¸­ç§»å‹•ä¸­         | SeatManager + Customer        | ç©ºãåº§å¸­å‰²å½“ã€ç§»å‹•é–‹å§‹                              |
| `seated`               | ç€å¸­            | SeatManager                   | é£Ÿäº‹ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹ (`stay_timer`)                  |
| `leaving`              | é€€åº—ä¸­           | SeatManager + Customer        | é£Ÿäº‹çµ‚äº†å¾Œã€å‡ºå£åº§æ¨™å‰²å½“ã€ç§»å‹•é–‹å§‹                        |
| `exited`               | å‡ºå£åˆ°ç€          | SeatManager + CustomerManager | ç§»å‹•å®Œäº†åˆ¤å®šã€åº§å¸­è§£æ”¾                              |
| `customer_deleted`     | é¡§å®¢å‰Šé™¤ & ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–° | CustomerManager               | é¡§å®¢ãƒªã‚¹ãƒˆå‰Šé™¤ã€æ¥å®¢ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–° (`customer_count += 1`) |

---

## 2ï¸âƒ£ é¡§å®¢ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

![image.png](./deepseek_mermaid_20250824_b460e8.png)

---

### ğŸ”¹ ãƒã‚¤ãƒ³ãƒˆ

* **è¡¨**ã§çŠ¶æ…‹ç®¡ç†ã¨æ‹…å½“è€…ã‚’æ˜ç¤º
* **ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³**ã§å®Ÿéš›ã®å‘¼ã³å‡ºã—ã‚„çŠ¶æ…‹é·ç§»ã‚’è¿½ãˆã‚‹
* CustomerManagerã¯ã€Œå…¥å£å‰²å½“ãƒ»å¾…æ©Ÿç®¡ç†ãƒ»å‰Šé™¤ã€
* SeatManagerã¯ã€Œåº§å¸­å‰²å½“ãƒ»ç€å¸­ãƒ»é€€åº—ç®¡ç†ã€
* Customerã¯ã€Œç§»å‹•ãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ä½ç½®æ›´æ–°ã€

---


